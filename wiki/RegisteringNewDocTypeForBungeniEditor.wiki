#summary How to register a new document type for BungeniEditor
#labels BungeniEditorClient

*Table of Contents*

* [RegisteringNewDocTypeForBungeniEditor#Introduction Introduction] 

* [RegisteringNewDocTypeForBungeniEditor#Create_the_template_for_the_document_type  Create a template for the document type] 

* [RegisteringNewDocTypeForBungeniEditor#Create_a_Metadata_Editor_for_the_document_type Create a metadata editor for the document type] 

* [RegisteringNewDocTypeForBungeniEditor#Register_the_new_Document_Type Register the new document type] 


= Introduction =

The BungeniEditor supports multiple document types.  Additional document types can be added by adding configuration entries into the editor's settings database.
The following steps describe the config entries required to register a new document type in the editor.

== Create the template for the document type == 

The templates for the different document types are stored under the workspace/templates folder.

Create a template for the new document type (you can modify and renmae the templates for the hansard or bill). The root section of the document must be renamed to the name of the document type. e.g. the root section of the bill document type is called 'bill' ; for the debaterecord document type it is called 'debaterecord'


== Create a Metadata Editor for the document type == 

In typical circumstances you can use the GeneralMetadata editor class which provides a generic metadata editor UI for typically used AkomaNtoso metadata. Custom metadata editors can be written for a document type if you want to provide an editor for additional metadata variables. To do this you will have to write a JPanel UI class which extends `BaseEditorDocMetadataDialog` e.g :
{{{

public class MyDocTypeMetadata extends BaseEditorDocMetadataDialog {

....
}

}}}
A generic metadata metadata model is provided by the `GeneralMetadataModel` class. You can extend the general metadata model by writing your own class either by extending GeneralMetadataModel or BaseEditorDocMetaModel.  The new class needs to be registered for the document type using the document_types.metadata_model_editor config setting (see below).

The metadata editor is registered in the DOCUMENT_TYPES settings table in the METADATA_MODEL_EDITOR column. See the next section of how to set the DOCUMENT_TYPES settings.




== Register the new Document Type ==

Launch the settings editor

Make an entry in the settings db's DOCUMENT_TYPES table, for e.g. if we were registering the bill document type, the following entry will be required :

|| DOC_TYPE || DESCRIPTION || TEMPLATE_PATH ||METADATA_MODEL_EDITOR||
|| debaterecord || debate record || workspace/templates/hansard.ott||org.bungeni.editor.metadata.editors.GeneralMetadata||
|| bill || bill document || workspace/templates/bill.ott||org.bungeni.editor.metadata.editors.BillMetadata||

The DOC_TYPE column records the document type identifier used by the system.
The TEMPLATE_PATH points to the document template for the document type.
The METADATA_MODEL_EDITOR sets the metadata model editor for the document type (in the above example, the 'debaterecord' document type is set to use the GeneralMetadata model / editor while the 'bill' document type uses a customized metadata model...




== Registering Panels for the document type == 

In the settings editor you also need to register available panels for the document type :

There are various panels provided for editing document metadata, viewing section metadata adding editor notes to the document etc.

The example below registers the document metadata panel and the document notes panel for the 'judgement' document type.

||DOCTYPE || PANEL_TYPE || PANEL_CLASS || PANEL_LOAD_ORDER || PANEL_TITLE || PANEL_DESC || STATE ||
||judgement||tabbed||org.bungeni.editor.panels.loadable.documentMetadataPanel||2||Document Metadata||Document metadata||1||
||judgement||tabbed||org.bungeni.editor.panels.loadable.documentNotesPanel||1||Document Notes||Document notes and document switcher||1||

== Enable available actions for the document type ==

Available action conditions for a document type are registered in the TOOLBAR_CONDITIONS table :

||DOCTYPE||CONDITION_NAME||CONDITION_CLASS||  
||debaterecord||fieldNotExists||org.bungeni.editor.toolbar.conditions.runnable.fieldNotExists||
||debaterecord||fieldExists||org.bungeni.editor.toolbar.conditions.runnable.fieldExists||


You can also import conditions form an existing doc type to the new doctype by using a SQL script for e.g. the following script imports all the conditions for the 'debaterecord' document type into the 'judgement' document type:
{{{
insert into toolbar_conditions ( doctype , condition_name, condition_class )
select 'judgement' , condition_name, condition_class from toolbar_conditions  where doctype  = 'debaterecord'
}}}



== Registering an Action set for the document type == 

Every document type is associated with an action set which is presented as a hierarchichal toolbar. The action set is defined in a XML file defined in the TOOLBAR_XML_CONFIG table. An action set for a document type can make use of actions available to that document type (refer to the previous sections on how to make actions  availabe for a document type)

The example below defines action sets for both the bill and the debaterecord document type.

||DOC_TYPE||TOOLBAR_XML||
||bill||settings/toolbar_bill.xml||
||debaterecord||settings/toolbar_debate.xml||


The action sets in the above example are present in the 'settings' folder of the editor installation. An action set is represented in XML and uses a particular syntax.  For details about action sets / and available actions provided by the editor refer to [http://code.google.com/p/bungeni-editor/wiki/ConditionProcessorsInBungeniEditor#Currently_Available_Conditions Condition Processors in Bungeni-Editor]

== Set the root section parameter for the document type == 

Every document type used by the editor must have a root section. The root section has the BungeniSectionType attribute set to 'body'. The root section is identified by a GENERAL_EDITOR_PROPERTIES property which takes the form :

||property name|| property value||
||root:judgement||judgement||

This identifies the root section for the judgement document type as 'judgement'





<<<< TO DO >>>>> 